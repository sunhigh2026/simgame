/* ========== ã‚¤ãƒ™ãƒ³ãƒˆå®šç¾© ========== */
const EVENTS = [
  // --- 1æœŸ ---
  {
    id: 'ev_first_day',
    period: 1, month: 1,
    title: 'ðŸ¢ åˆæ—¥ã®ç·Šå¼µ',
    text: 'ä¼šç¤¾è¨­ç«‹å®Œäº†ã€‚ç™»è¨˜ãŒçµ‚ã‚ã‚Šã€ä»Šæ—¥ã‹ã‚‰æ­£å¼ã«ç¤¾é•·ã ã€‚ä½•ã‹ã‚‰å§‹ã‚ã‚‹ã¹ãã‹â€¦',
    choices: [
      { text: 'ã¾ãšã¯æ°—åˆã„ã‚’å…¥ã‚Œã‚‹ï¼', effect: { hpRecover: 1 },
        successText: 'ã‚„ã‚‹ãžï¼æ–°ã—ã„äººç”Ÿã®å§‹ã¾ã‚Šã ã€‚ä½“åŠ›+1' },
      { text: 'è¨ˆç”»ã‚’ç«‹ã¦ç›´ã™', effect: { creditBonus: 1 },
        successText: 'å†·é™ã«ã€‚ã¾ãšã¯ä¸€æ­©ãšã¤ã€‚ä¿¡ç”¨+1' },
    ],
  },
  {
    id: 'ev_bank_account',
    period: 1, month: 2,
    title: 'ðŸ¦ æ³•äººå£åº§ã‚’é–‹è¨­ã—ã«è¡Œã',
    text: 'ä¼šç¤¾ã‚’ä½œã£ãŸã¯ã„ã„ãŒã€æ³•äººå£åº§ãŒãªã„ã¨å§‹ã¾ã‚‰ãªã„ã€‚ãƒ¡ã‚¬ãƒãƒ³ã‚¯ã«ç”³ã—è¾¼ã¿ã«è¡Œãã‹ã€ãƒãƒƒãƒˆéŠ€è¡Œã«ã™ã‚‹ã‹ã€‚',
    choices: [
      { text: 'ãƒ¡ã‚¬ãƒãƒ³ã‚¯ã«ç”³ã—è¾¼ã‚€ï¼ˆä¿¡ç”¨åŠ›UPã€ãŸã ã—å¯©æŸ»åŽ³ã—ã„ï¼‰', effect: { creditBonus: 5, successChance: 0.4 },
        successText: 'å¯©æŸ»é€šéŽï¼ä¿¡ç”¨ã‚¹ã‚³ã‚¢+5',
        failText: 'å¯©æŸ»è½ã¡â€¦ã€Œå®Ÿç¸¾ãŒã§ããŸã‚‰ã¾ãŸæ¥ã¦ãã ã•ã„ã€ã¨è¨€ã‚ã‚ŒãŸã€‚ãƒãƒƒãƒˆéŠ€è¡Œã§é–‹è¨­ã—ãŸã€‚' },
      { text: 'ãƒãƒƒãƒˆéŠ€è¡Œã§é–‹è¨­ï¼ˆç¢ºå®Ÿï¼‰', effect: { creditBonus: 1 },
        successText: 'ã™ãã«é–‹è¨­å®Œäº†ã€‚ãƒãƒƒãƒˆã§å®Œçµã€ä¾¿åˆ©ã€‚ä¿¡ç”¨ã‚¹ã‚³ã‚¢+1' },
    ],
  },
  {
    id: 'ev_business_card',
    period: 1, month: 3,
    title: 'ðŸ“‡ ååˆºã‚’ä½œã‚‹',
    text: 'å–¶æ¥­ã™ã‚‹ã«ã¯ååˆºãŒå¿…è¦ã ã€‚ã©ã“ã¾ã§ã“ã ã‚ã‚‹ï¼Ÿ',
    choices: [
      { text: 'ãƒãƒƒãƒˆå°åˆ·ã§æœ€ä½Žé™ï¼ˆÆ³2,000ï¼‰', effect: { cost: 2000, creditBonus: 0 },
        successText: 'ã‚·ãƒ³ãƒ—ãƒ«ãªååˆºãŒå±Šã„ãŸã€‚ã¾ã‚ã€ã“ã‚Œã§ååˆ†ã€‚' },
      { text: 'ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ã«é ¼ã‚€ï¼ˆÆ³30,000ï¼‰', effect: { cost: 30000, creditBonus: 3 },
        successText: 'ãŠã—ã‚ƒã‚ŒãªååˆºãŒã§ããŸï¼ã€Œã„ã„ååˆºã§ã™ã­ã€ã¨è¨€ã‚ã‚Œã‚‹ã“ã¨ãŒå¢—ãˆãŸã€‚ä¿¡ç”¨+3' },
    ],
  },
  {
    id: 'ev_first_meeting',
    period: 1, month: 4,
    title: 'ðŸ¤ åˆã‚ã¦ã®å•†è«‡',
    text: 'åˆã‚ã¦ã®æœ¬æ ¼çš„ãªå•†è«‡ã€‚ç·Šå¼µã§å£°ãŒéœ‡ãˆã‚‹â€¦',
    condition: (state) => state.projects.length === 0,
    choices: [
      { text: 'èª å®Ÿã«å¯¾å¿œã™ã‚‹', effect: { creditBonus: 2, successChance: 0.6 },
        successText: 'ç·Šå¼µã—ãŸãŒã€ãªã‚“ã¨ã‹ä¹—ã‚Šåˆ‡ã£ãŸï¼ä¿¡ç”¨+2',
        failText: 'ç·Šå¼µã—ã™ãŽã¦å¤±æ•—â€¦ã§ã‚‚æ¬¡ã«ã¤ãªã’ã‚ˆã†ã€‚' },
      { text: 'äº‹å‰æº–å‚™ã‚’å¾¹åº•ã™ã‚‹ï¼ˆä½“åŠ›-1ï¼‰', effect: { hpCost: 1, creditBonus: 3 },
        successText: 'æº–å‚™ãŒåŠŸã‚’å¥ã—ãŸï¼ã€Œã—ã£ã‹ã‚Šã—ã¦ã¾ã™ã­ã€ã¨è¨€ã‚ã‚ŒãŸã€‚ä¿¡ç”¨+3' },
    ],
  },
  {
    id: 'ev_first_revenue',
    period: 1, month: 4,
    title: 'ðŸŽ‰ åˆã‚ã¦ã®å…¥é‡‘ï¼',
    text: 'ã¤ã„ã«åˆã‚ã¦ã®å£²ä¸ŠãŒå£åº§ã«æŒ¯ã‚Šè¾¼ã¾ã‚ŒãŸæ—¥ã€‚é€šå¸³ã‚’ä½•åº¦ã‚‚è¦‹è¿”ã—ã¦ã—ã¾ã†ã€‚',
    condition: (state) => state.totalRevenue > 0,
    choices: [
      { text: 'æ°—ã‚’å¼•ãç· ã‚ã¦æ¬¡ã®æ¡ˆä»¶ã¸', effect: { hpRecover: 2 }, successText: 'åˆå…¥é‡‘ã®å¬‰ã—ã•ã‚’ãƒãƒã«é ‘å¼µã‚ã†ã€‚ä½“åŠ›+2' },
    ],
  },
  {
    id: 'ev_withholding',
    period: 1, month: 5,
    title: 'ðŸ“ æºæ³‰å¾´åŽã£ã¦ä½•ï¼Ÿ',
    text: 'è«‹æ±‚æ›¸ã‚’å‡ºã—ãŸã‚‰ã€Œæºæ³‰å¾´åŽã—ã¾ã™ã­ã€ã¨è¨€ã‚ã‚ŒãŸã€‚ãˆã€å£²ä¸Šã‹ã‚‰å¼•ã‹ã‚Œã‚‹ã®ï¼Ÿ',
    choices: [
      { text: 'èª¿ã¹ã¦ç†è§£ã™ã‚‹', effect: { hpCost: 1 },
        successText: 'æ‰€å¾—ç¨Žã®å‰æ‰•ã„çš„ãªåˆ¶åº¦ã ã¨ã‚ã‹ã£ãŸã€‚æœ€çµ‚çš„ã«ã¯ç¢ºå®šç”³å‘Šã§èª¿æ•´ã•ã‚Œã‚‹ã€‚å‹‰å¼·ã«ãªã£ãŸï¼' },
      { text: 'ç¨Žç†å£«ã«èžã', effect: {},
        successText: state => state.accountant !== 'none'
          ? 'ä½è—¤ç¨Žç†å£«ã€Œæºæ³‰ã¯å£²ä¸Šã®10.21%ãŒå¤©å¼•ãã•ã‚Œã¾ã™ãŒã€æ³•äººãªã‚‰åŸºæœ¬é–¢ä¿‚ãªã„ã§ã™ã‚ˆã€'
          : 'â€¦ç¨Žç†å£«ãŒã„ãªã„ã®ã§è‡ªåˆ†ã§èª¿ã¹ã‚‹ã—ã‹ãªã„ã€‚' },
    ],
  },
  {
    id: 'ev_invoice',
    period: 1, month: 6,
    title: 'ðŸ“„ è«‹æ±‚æ›¸ã®æ›¸ãæ–¹',
    text: 'è«‹æ±‚æ›¸ã‚’ä½œæˆä¸­ã€‚æŒ¯è¾¼å…ˆã€æ”¯æ‰•æ¡ä»¶ã€æ¶ˆè²»ç¨Žâ€¦è¨˜è¼‰äº‹é …ãŒå¤šãã¦æ··ä¹±ã™ã‚‹ã€‚',
    choices: [
      { text: 'ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æŽ¢ã—ã¦çœŸä¼¼ã‚‹', effect: { hpCost: 1 },
        successText: 'ãƒãƒƒãƒˆã§è¦‹ã¤ã‘ãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å‚è€ƒã«ä½œæˆå®Œäº†ã€‚' },
      { text: 'ä¼šè¨ˆã‚½ãƒ•ãƒˆã‚’å°Žå…¥ï¼ˆÆ³12,000/å¹´ï¼‰', effect: { cost: 12000 },
        successText: 'ä¼šè¨ˆã‚½ãƒ•ãƒˆã§è‡ªå‹•ç”Ÿæˆã€‚æ¥½ã«ãªã£ãŸï¼' },
    ],
  },
  {
    id: 'ev_living_crisis',
    period: 1, month: 7,
    title: 'ðŸ’¸ ç”Ÿæ´»è²»ãŒè¶³ã‚Šãªã„ï¼',
    text: 'å½¹å“¡å ±é…¬ã‚’ä½Žãè¨­å®šã—ã™ãŽãŸã‹ã‚‚ã€‚å€‹äººã®è²¯é‡‘ã‚‚æ¸›ã£ã¦ããŸâ€¦ã€‚',
    condition: (state) => state.salary <= 150000,
    choices: [
      { text: 'ç¯€ç´„ã—ã¦è€ãˆã‚‹ï¼ˆä½“åŠ›-2ï¼‰', effect: { hpCost: 2 }, successText: 'è‡ªç‚Šã¨ã‚¯ãƒ¼ãƒãƒ³ã§ä¹—ã‚Šåˆ‡ã£ãŸã€‚ä½“ãŒã‚­ãƒ„ã„â€¦ã€‚' },
      { text: 'å€‹äººè²¯é‡‘ã‹ã‚‰ä¼šç¤¾ã«è²¸ä»˜ï¼ˆÆ³300,000ï¼‰', effect: { cashInflow: 300000 }, successText: 'å½¹å“¡å€Ÿå…¥é‡‘ã¨ã—ã¦å‡¦ç†ã€‚ã„ã¤ã‹è¿”ã—ã¦ã‚‚ã‚‰ãŠã†â€¦ã€‚' },
    ],
  },
  {
    id: 'ev_pc_trouble',
    period: 1, month: 8,
    title: 'ðŸ’» PCãŒå£Šã‚ŒãŸï¼',
    text: 'ä»•äº‹ç”¨ã®PCãŒçªç„¶å‹•ã‹ãªããªã£ãŸã€‚ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¯â€¦ã‚ã£ãŸã£ã‘ï¼Ÿ',
    choices: [
      { text: 'ä¿®ç†ã«å‡ºã™ï¼ˆÆ³30,000ã€1é€±é–“ï¼‰', effect: { cost: 30000, hpCost: 2 },
        successText: 'ä¿®ç†å®Œäº†ã€‚ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®å¤§åˆ‡ã•ã‚’å­¦ã‚“ã â€¦ä½“åŠ›-2' },
      { text: 'æ–°ã—ã„PCã‚’è²·ã†ï¼ˆÆ³150,000ï¼‰', effect: { cost: 150000 },
        successText: 'æ–°å“ã®PCã¯å¿«é©ã€‚ã“ã‚Œã§ä»•äº‹åŠ¹çŽ‡ã‚‚ã‚¢ãƒƒãƒ—ã™ã‚‹ã¯ãšã€‚' },
    ],
  },
  {
    id: 'ev_first_complaint',
    period: 1, month: 9,
    title: 'ðŸ˜° åˆã‚ã¦ã®ã‚¯ãƒ¬ãƒ¼ãƒ ',
    text: 'ç´å“ã—ãŸæˆæžœç‰©ã«ã‚¯ãƒ¬ãƒ¼ãƒ ãŒâ€¦ã€Œã‚¤ãƒ¡ãƒ¼ã‚¸ã¨é•ã†ã€ã¨è¨€ã‚ã‚Œã¦ã—ã¾ã£ãŸã€‚',
    condition: (state) => state.totalRevenue > 0,
    choices: [
      { text: 'èª å®Ÿã«å¯¾å¿œã—ã¦ä¿®æ­£', effect: { hpCost: 2, creditBonus: 2 },
        successText: 'ä¸å¯§ã«å¯¾å¿œã—ãŸçµæžœã€é€†ã«ä¿¡é ¼ã‚’å¾—ã‚‰ã‚ŒãŸã€‚ä¿¡ç”¨+2' },
      { text: 'èª¬æ˜Žã—ã¦ç†è§£ã‚’æ±‚ã‚ã‚‹', effect: { successChance: 0.5, creditBonus: 1 },
        successText: 'èª¬æ˜Žã§ç´å¾—ã—ã¦ã‚‚ã‚‰ãˆãŸã€‚ä¿¡ç”¨+1',
        failText: 'èª¬æ˜Žã§ã¯ç´å¾—ã—ã¦ã‚‚ã‚‰ãˆãšã€çµå±€ä¿®æ­£ã™ã‚‹ã“ã¨ã«â€¦' },
    ],
  },
  {
    id: 'ev_year_end_prep',
    period: 1, month: 10,
    title: 'ðŸ“Š å¹´æœ«èª¿æ•´ï¼Ÿ',
    text: 'ã€Œå¹´æœ«èª¿æ•´ã®æ›¸é¡žã‚’â€¦ã€ã¨ã„ã†è©±ã‚’èžã„ãŸã€‚ä¸€äººç¤¾é•·ã«ã¯é–¢ä¿‚ã‚ã‚‹ï¼Ÿ',
    choices: [
      { text: 'èª¿ã¹ã¦ã¿ã‚‹', effect: { hpCost: 1 },
        successText: 'ä¸€äººç¤¾é•·ã§ã‚‚å¹´æœ«èª¿æ•´ã¯å¿…è¦ã€‚çµ¦ä¸Žæ˜Žç´°ã‚„æºæ³‰å¾´åŽç¥¨ã‚’ä½œã‚‰ãªã„ã¨ã€‚' },
      { text: 'ç¨Žç†å£«ã«ä»»ã›ã‚‹', effect: {},
        successText: state => state.accountant !== 'none'
          ? 'ç¨Žç†å£«ã€ŒãŠä»»ã›ãã ã•ã„ã€‚æ›¸é¡žã¯æº–å‚™ã—ã¦ãŠãã¾ã™ã€'
          : 'ç¨Žç†å£«ãŒã„ãªã„ã®ã§è‡ªåˆ†ã§ã‚„ã‚‹ã—ã‹ãªã„â€¦' },
    ],
  },
  {
    id: 'ev_social_ins_notice',
    period: 1, month: 11,
    title: 'ðŸ“¬ ç¤¾ä¼šä¿éšœåºã‹ã‚‰æ‰‹ç´™',
    text: 'ã€Œç¤¾ä¼šä¿é™ºã®å±Šå‡ºã«ã¤ã„ã¦ã€ã¨ã„ã†å°ç­’ãŒå±Šã„ãŸã€‚ä½•ã‹æ‰‹ç¶šããŒå¿…è¦ï¼Ÿ',
    choices: [
      { text: 'ã¡ã‚ƒã‚“ã¨å¯¾å¿œã™ã‚‹', effect: { hpCost: 1, creditBonus: 1 },
        successText: 'å±Šå‡ºã‚’æå‡ºå®Œäº†ã€‚ç¤¾ä¼šä¿é™ºæ–™ã®è¨ˆç®—ã‚‚ç¢ºèªã—ãŸã€‚ä¿¡ç”¨+1' },
      { text: 'å¾Œã§å¯¾å¿œã™ã‚‹', effect: { },
        successText: 'ä»Šã¯å¿™ã—ã„â€¦ã§ã‚‚ã„ãšã‚Œå¯¾å¿œã—ãªã„ã¨ã€‚' },
    ],
  },
  {
    id: 'ev_first_settlement',
    period: 1, month: 12,
    title: 'ðŸ“ˆ åˆã‚ã¦ã®æ±ºç®—',
    text: '1å¹´ç›®ã®æ±ºç®—ãŒè¿‘ã¥ã„ã¦ããŸã€‚å£²ä¸Šã€çµŒè²»ã€ç¨Žé‡‘â€¦å…¨éƒ¨æŠŠæ¡ã§ãã¦ã‚‹ï¼Ÿ',
    choices: [
      { text: 'è‡ªåˆ†ã§é ‘å¼µã‚‹ï¼ˆä½“åŠ›-3ï¼‰', effect: { hpCost: 3 },
        successText: 'å¾¹å¤œã§å¸³ç°¿ã¨æ ¼é—˜â€¦ãªã‚“ã¨ã‹æ•°å­—ã‚’ã¾ã¨ã‚ãŸã€‚' },
      { text: 'ç¨Žç†å£«ã«ç›¸è«‡', effect: {},
        successText: state => state.accountant !== 'none'
          ? 'ç¨Žç†å£«ã€Œå¤§ä¸ˆå¤«ã§ã™ã€ä¸€ç·’ã«ç¢ºèªã—ã¾ã—ã‚‡ã†ã€å¿ƒå¼·ã„ã€‚'
          : 'ç¨Žç†å£«ãŒã„ãªã„â€¦æ¥å¹´ã“ãã¯å¥‘ç´„ã—ã‚ˆã†ã€‚' },
    ],
  },

  // --- å¾“æ¥­å“¡ã‚¤ãƒ™ãƒ³ãƒˆ ---
  {
    id: 'ev_emp_praise',
    period: 2, month: 2,
    title: 'ðŸ‘ å¾“æ¥­å“¡ãŒå¥½èª¿',
    text: 'å¾“æ¥­å“¡ã®ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ãŒé«˜ã„ã€‚ã€Œã“ã®ä¼šç¤¾ã§åƒã‘ã¦è‰¯ã‹ã£ãŸã€ã¨è¨€ã£ã¦ãã‚ŒãŸã€‚',
    condition: (state) => state.employees.some(e => e.satisfaction >= 80),
    choices: [
      { text: 'æ„Ÿè¬ã‚’ä¼ãˆã‚‹', effect: { satisfactionUp: 5 },
        successText: 'ã€Œã“ã‚Œã‹ã‚‰ã‚‚ä¸€ç·’ã«é ‘å¼µã‚ã†ã€æº€è¶³åº¦+5' },
      { text: 'è‡¨æ™‚ãƒœãƒ¼ãƒŠã‚¹ã‚’å‡ºã™ï¼ˆÆ³50,000ï¼‰', effect: { cost: 50000, satisfactionUp: 15 },
        successText: 'ã€Œç¤¾é•·ã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼ã€æº€è¶³åº¦+15' },
    ],
  },
  {
    id: 'ev_emp_complaint',
    period: 2, month: 5,
    title: 'ðŸ˜Ÿ å¾“æ¥­å“¡ã®ä¸æº€',
    text: 'å¾“æ¥­å“¡ãŒæµ®ã‹ãªã„é¡”ã‚’ã—ã¦ã„ã‚‹ã€‚ã€Œã¡ã‚‡ã£ã¨è©±ãŒã‚ã‚‹ã‚“ã§ã™ãŒâ€¦ã€',
    condition: (state) => state.employees.some(e => e.satisfaction < 40),
    choices: [
      { text: 'è©±ã‚’èžã', effect: { hpCost: 1, satisfactionUp: 10 },
        successText: 'ä¸æº€ã‚’èžã„ã¦æ”¹å–„ã‚’ç´„æŸã—ãŸã€‚å°‘ã—å®‰å¿ƒã—ãŸã‚ˆã†ã ã€‚æº€è¶³åº¦+10' },
      { text: 'ä»Šã¯å¿™ã—ã„ã¨ä¼ãˆã‚‹', effect: { satisfactionDown: 10 },
        successText: 'ã€Œâ€¦ã‚ã‹ã‚Šã¾ã—ãŸã€ã•ã‚‰ã«ä¸æº€ãŒæºœã¾ã£ãŸã‚ˆã†ã ã€‚æº€è¶³åº¦-10' },
    ],
  },

  // --- 2æœŸ ---
  {
    id: 'ev_salary_negotiation',
    period: 2, month: 3,
    title: 'ðŸ’¬ å¾“æ¥­å“¡ã‹ã‚‰çµ¦æ–™äº¤æ¸‰',
    text: 'ã€Œç¤¾é•·ã€ã¡ã‚‡ã£ã¨ãŠè©±ãŒâ€¦ã€',
    condition: (state) => state.employees.length > 0,
    choices: [
      { text: 'æœˆÆ³20,000ä¸Šã’ã‚‹', effect: { salaryUp: 20000, satisfactionUp: 15 }, successText: 'å¬‰ã—ãã†ã ã€‚ã‚„ã‚‹æ°—ã‚‚ä¸ŠãŒã£ãŸã¿ãŸã„ã€‚' },
      { text: 'ä»Šã¯åŽ³ã—ã„ã¨ä¼ãˆã‚‹', effect: { satisfactionDown: 10 }, successText: 'ã€Œã‚ã‹ã‚Šã¾ã—ãŸâ€¦ã€å°‘ã—ä¸æº€ãã†ã ã€‚' },
      { text: 'è³žä¸Žã§å¯¾å¿œã™ã‚‹ã¨ç´„æŸ', effect: { satisfactionUp: 5 }, successText: 'ã€ŒæœŸå¾…ã—ã¦ã¾ã™ï¼ã€â€¦ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ã ã€‚' },
    ],
  },
  {
    id: 'ev_late_payment',
    period: 2, month: 6,
    title: 'âš ï¸ å…¥é‡‘ãŒé…ã‚Œã¦ã„ã‚‹ï¼',
    text: 'å…ˆæœˆç´å“ã—ãŸæ¡ˆä»¶ã®å…¥é‡‘ãŒæ¥ãªã„ã€‚å‚¬ä¿ƒã™ã‚‹ã‹ï¼Ÿ',
    choices: [
      { text: 'ã‚„ã‚“ã‚ã‚Šå‚¬ä¿ƒ', effect: { successChance: 0.6 },
        successText: 'ã€Œã™ã¿ã¾ã›ã‚“ã€æ¥é€±æŒ¯ã‚Šè¾¼ã¿ã¾ã™ã€ç„¡äº‹å…¥é‡‘ã•ã‚ŒãŸã€‚',
        failText: 'ã€Œã‚‚ã†å°‘ã—å¾…ã£ã¦ãã ã•ã„ã€â€¦æ¥æœˆã«æŒã¡è¶Šã—ã€‚' },
      { text: 'å¼·ã‚ã«å‚¬ä¿ƒ', effect: { successChance: 0.85, creditEffect: -2 },
        successText: 'ç¿Œæ—¥å…¥é‡‘ã•ã‚ŒãŸã€‚ãŸã ã—é–¢ä¿‚ã¯å°‘ã—æ‚ªåŒ–ã€‚',
        failText: 'é€†ã‚®ãƒ¬ã•ã‚ŒãŸã€‚ã€Œã‚‚ã†ãŠå®…ã«ã¯é ¼ã¾ãªã„ã€ä¿¡ç”¨-2' },
      { text: 'å¾…ã¤', effect: { delayMonths: 1 },
        successText: 'ç¿Œæœˆã€ç„¡äº‹ã«å…¥é‡‘ã•ã‚ŒãŸã€‚ãƒ›ãƒƒã¨ã—ãŸã€‚' },
    ],
  },

  // --- 3æœŸ ---
  {
    id: 'ev_big_project',
    period: 3, month: 4,
    title: 'ðŸ¢ å¤§æ‰‹ä¼æ¥­ã‹ã‚‰å•ã„åˆã‚ã›ï¼',
    text: 'ãƒˆãƒ¼ã‚­ãƒ§åŒºã®å¤§æ‰‹ä¼æ¥­ã‹ã‚‰ã€Œã‚µã‚¤ãƒˆãƒªãƒ‹ãƒ¥ãƒ¼ã‚¢ãƒ«ã®è¦‹ç©ã‚‚ã‚Šã‚’ã€ã¨é€£çµ¡ãŒæ¥ãŸï¼å¤§ããªãƒãƒ£ãƒ³ã‚¹ã ãŒâ€¦',
    choices: [
      { text: 'å…¨åŠ›ã§ææ¡ˆã™ã‚‹ï¼ˆä½“åŠ›-4ï¼‰', effect: { hpCost: 4, projectChance: 0.5, bigProject: true },
        successText: 'å—æ³¨æˆåŠŸï¼å ±é…¬Æ³2,000,000ã®å¤§åž‹æ¡ˆä»¶ã ï¼',
        failText: 'æƒœã—ãã‚‚è½é¸ã€‚ã€Œã¾ãŸã®æ©Ÿä¼šã«ã€â€¦ã§ã‚‚è‰¯ã„çµŒé¨“ã«ãªã£ãŸã€‚ä¿¡ç”¨+3' },
      { text: 'ç„¡ç†ã›ãšæ–­ã‚‹', effect: { hpCost: 0 },
        successText: 'èº«ã®ä¸ˆã«åˆã£ãŸä»•äº‹ã‚’ã—ã‚ˆã†ã€‚å …å®Ÿã ã€‚' },
    ],
  },

  // --- 4æœŸ ---
  {
    id: 'ev_tax_audit',
    period: 4, month: 8,
    title: 'ðŸ” ç¨Žå‹™èª¿æŸ»ã®é€šçŸ¥ãŒå±Šã„ãŸ',
    text: 'ç¨Žå‹™ç½²ã‹ã‚‰é€£çµ¡ãŒâ€¦ï¼ã€Œæ¥æœˆã€å¾¡ç¤¾ã®å¸³ç°¿ã‚’ç¢ºèªã•ã›ã¦ãã ã•ã„ã€',
    choices: [
      { text: 'ç¨Žç†å£«ã«ç›¸è«‡ã—ã¦æº–å‚™ã™ã‚‹', effect: {},
        successText: state => state.accountant !== 'none'
          ? `${DATA.ACCOUNTANTS[state.accountant].name}ã€Œå¤§ä¸ˆå¤«ã§ã™ã€ã—ã£ã‹ã‚Šæº–å‚™ã—ã¾ã—ã‚‡ã†ã€â†’ å•é¡Œãªãçµ‚äº†ã€‚`
          : 'ç¨Žç†å£«ãŒã„ãªã„ï¼è‡ªåˆ†ã§å¸³ç°¿ã‚’æ•´ç†ã™ã‚‹ã—ã‹ãªã„â€¦ï¼ˆä½“åŠ›-4ã€ãƒšãƒŠãƒ«ãƒ†ã‚£ãƒªã‚¹ã‚¯ã‚ã‚Šï¼‰' },
      { text: 'ã¨ã‚Šã‚ãˆãšå¸³ç°¿ã‚’è¦‹ç›´ã™ï¼ˆä½“åŠ›-3ï¼‰', effect: { hpCost: 3, auditPenaltyChance: 0.3 },
        successText: 'ä½•ã¨ã‹ä¹—ã‚Šåˆ‡ã£ãŸã€‚ãƒ’ãƒ¤ãƒ’ãƒ¤ã—ãŸâ€¦',
        failText: 'çµŒè²»ã®ä¸€éƒ¨ãŒå¦èªã•ã‚ŒãŸã€‚è¿½å¾´èª²ç¨ŽÆ³150,000â€¦ç—›ã„ã€‚' },
    ],
  },

  // --- 5æœŸ ---
  {
    id: 'ev_ma_offer',
    period: 5, month: 6,
    title: 'ðŸ’° M&Aã®æ‰“è¨ºãŒæ¥ãŸ',
    text: 'ã€Œå¾¡ç¤¾ã‚’è²·åŽã—ãŸã„ã®ã§ã™ãŒâ€¦ã€å¤§æ‰‹ã‹ã‚‰å£°ãŒã‹ã‹ã£ãŸã€‚',
    condition: (state) => state.totalRevenue > 20000000,
    choices: [
      { text: 'è©±ã‚’èžã„ã¦ã¿ã‚‹', effect: { exitOption: true },
        successText: 'æ¡ä»¶æ¬¡ç¬¬ã§ã¯EXITã‚‚é¸æŠžè‚¢ã«ã€‚æœ€çµ‚æ±ºç®—å¾Œã«æ±ºæ–­ã§ãã‚‹ã€‚' },
      { text: 'æ–­ã‚‹', effect: {},
        successText: 'ã“ã®ä¼šç¤¾ã¯è‡ªåˆ†ã§è‚²ã¦ã‚‹ã€‚ã¾ã ã¾ã ã“ã‚Œã‹ã‚‰ã ã€‚' },
    ],
  },
];

function getMonthEvent(state) {
  const candidates = EVENTS.filter(e => {
    if (e.period !== state.period) return false;
    if (e.month !== state.month) return false;
    if (e.condition && !e.condition(state)) return false;
    if (state.completedEvents.includes(e.id)) return false;
    return true;
  });
  return candidates.length > 0 ? candidates[0] : null;
}

// ãƒ©ãƒ³ãƒ€ãƒ ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆç‰¹å®šæœˆã«ç´ã¥ã‹ãªã„ï¼‰
const RANDOM_EVENTS = [
  {
    id: 'rand_referral',
    text: 'ä»¥å‰ã®å–å¼•å…ˆã‹ã‚‰ç´¹ä»‹ãŒå…¥ã£ãŸï¼',
    chance: 0.1,
    effect: { projectDirect: true, tier: 1 },
    period: [1,2,3,4,5],
  },
  {
    id: 'rand_tool_discount',
    text: 'ä½¿ã£ã¦ã„ã‚‹ãƒ„ãƒ¼ãƒ«ãŒ30%å‰²å¼•ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ä¸­ï¼',
    chance: 0.08,
    effect: { costReduction: 0.3 },
    period: [1,2,3,4,5],
  },
  {
    id: 'rand_sick',
    text: 'é¢¨é‚ªã‚’ã²ã„ã¦ã—ã¾ã£ãŸâ€¦ä»Šæœˆã®ä½“åŠ›-3',
    chance: 0.08,
    effect: { hpCost: 3 },
    period: [1,2,3,4,5],
  },
  {
    id: 'rand_server_down',
    text: 'ã‚µãƒ¼ãƒãƒ¼ãŒãƒ€ã‚¦ãƒ³ï¼å¾©æ—§ã«æ™‚é–“ãŒã‹ã‹ã£ãŸã€‚',
    chance: 0.06,
    effect: { hpCost: 2, cost: 15000 },
    period: [1,2,3,4,5],
  },
  // è¿½åŠ ãƒ©ãƒ³ãƒ€ãƒ ã‚¤ãƒ™ãƒ³ãƒˆ
  {
    id: 'rand_cafe_meeting',
    text: 'ã‚«ãƒ•ã‚§ã§å¶ç„¶ã€æ½œåœ¨çš„ãªã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨å‡ºä¼šã£ãŸï¼ååˆºäº¤æ›ã‹ã‚‰è©±ãŒå¼¾ã‚€ã€‚',
    chance: 0.05,
    effect: { creditBonus: 3, projectDirect: true, tier: 0 },
    period: [1,2,3,4,5],
  },
  {
    id: 'rand_inspiration',
    text: 'æ·±å¤œã«ãµã¨ã‚¢ã‚¤ãƒ‡ã‚¢ãŒé™ã‚Šã¦ããŸï¼ã¤ã„ä½œæ¥­ã«æ²¡é ­ã—ã¦ã—ã¾ã£ãŸâ€¦',
    chance: 0.08,
    effect: { hpCost: 2, nextProjectBonus: true },
    period: [1,2,3,4,5],
  },
  {
    id: 'rand_family_worry',
    text: 'å®Ÿå®¶ã‹ã‚‰é›»è©±ã€‚ã€Œä»•äº‹ã†ã¾ãã„ã£ã¦ã‚‹ï¼Ÿå¤§ä¸ˆå¤«ï¼Ÿã€ã¨å¿ƒé…ã•ã‚Œã‚‹ã€‚',
    chance: 0.1,
    effect: { hpCost: 1 },
    period: [1,2,3,4,5],
  },
  {
    id: 'rand_competitor',
    text: 'åŒæ¥­ã®ç«¶åˆä¼šç¤¾ã‚’ç™ºè¦‹ã€‚ã©ã†ã‚„ã‚‰æœ€è¿‘å‹¢ã„ãŒã‚ã‚‹ã‚‰ã—ã„â€¦',
    chance: 0.06,
    effect: { creditBonus: 1 },
    period: [1,2,3,4,5],
  },
];

function checkRandomEvent(state) {
  const candidates = RANDOM_EVENTS.filter(e => e.period.includes(state.period));
  for (const ev of candidates) {
    if (Math.random() < ev.chance) return ev;
  }
  return null;
}
